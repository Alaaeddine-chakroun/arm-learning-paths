---
title: Automate training and testing
weight: 4

### FIXED, DO NOT MODIFY
layout: learningpathall
---

## GitHub Actions workflows

### Train Model

TODO: update these scripts to the final form, update images from final repository

In this Learning Path, you execute the script through the _Train Model_ workflow in the GitHub Actions UI. This workflow pulls a Docker container with PyTorch configured from DockerHub, and runs the training in that container. The model file returned from the python script is saved as an artifact to the job.

```yaml
name: Train Model

on:
  workflow_dispatch:

jobs:
  train-model:
    name: Train the Model
    runs-on: ubuntu-22.04-arm-os # Custom ARM64 runner
    container:
      image: armswdev/pytorch-arm-neoverse:r24.07-torch-2.3.0-openblas
      options: --user root
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      - name: Run training script
        run: python scripts/train_model.py
      - name: Upload Artifact
        uses: actions/upload-artifact@v4
        with:
          name: traffic_sign_net
          path: ${{ github.workspace }}/models/traffic_sign_net.pth
          retention-days: 5
```

Navigate to the _Train Model_ workflow under the _Actions_ tab, and press the _Run workflow_ button. Your artifact can be used to run the next step: testing the performance.

### Test Model

Similarly to `train_model.py`, there is an associated workflow which executes in a Docker container: _Test Model_. The test job downloads the artifact generated by the training job, and runs inference with the version of PyTorch installed in the container.

```yaml
name: Test Model

on:
  workflow_dispatch:

jobs:
  test-model:
    name: Test the Model
    runs-on: ubuntu-22.04-arm-os # Custom ARM64 runner
    container:
      image: armswdev/pytorch-arm-neoverse:r24.07-torch-2.3.0-openblas
      options: --user root
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      - name: Download artifacts
        uses: actions/download-artifact@v4
        with:
          name: traffic_sign_net
          run-id: <11 digit run ID>
          github-token: ${{ secrets.GITHUB_TOKEN }}
      - name: Run testing script
        run: python scripts/test_model.py --model traffic_sign_net.pth

```

In order to use the model created by your _Train Model_ job, you can edit the _Test Model_ workflow file.

Open the training job which uploaded the ML model as an artifact by navigating to the _Actions_ tab on your GitHub repository. Choose the _Train Model_ under _All workflows_, and select the latest successful job. The URL from here contains an 11-digit number. Note down this number, which is the _run ID_ which is used to pick up the model for testing. Open the workflow file for _Test Model_, `test-model.yml`, and update the `run-id` parameter. Save the file.

![#run-id](/images/run-id.png)

Trigger the _Test Model_ job by pressing the _Run workflow_ button in the job's overview. You can check the output to see how the artifact you generated is used for testing.

![#run-workflow](/images/run-workflow.png)

In the next section, you learn how to modify the testing workflow to improve the inference performance of the model.