{{/*
Contians all javascript functions to include, specific to each page.

Where it is used:
    - all

Called from:
    - baseof (the end)
*/}}

<!-- Hugo processing -->
{{$is_content := or (eq .Layout "learningpathall") (eq .Layout "installtoolsall")}}
{{$is_list := and (not $is_content) (.IsNode) (not .IsHome) }}             <!-- includes about for now... should exclude -->                                         


<!-- Feedback is on     _next-steps.md learning path          install tool everything-->

<!-- All pages -->
{{$all_page_js := slice (resources.Get "js/stored-user-preferences.js") (resources.Get "js/anonymous-analytics.js") (resources.GetRemote "https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js") (resources.Get "js/cookie-init.js")}}

<!-- Homepage only -->
{{if .IsHome }}
    {{ $js_home := $all_page_js | append 
        (resources.Get "js/search-and-filter/search-handling.js") (resources.Get "/js/search-and-filter/change-handler-search-hook.js")
        | resources.Concat "js/mini_home.js" | minify | fingerprint  }}
    <script href="{{ $js_home.Permalink }}" defer></script>
{{end}}

<!-- List pages only -->
{{if $is_list}}
    {{ $js_list := $all_page_js | append 
        (resources.Get "/js/search-and-filter/filter-learning-paths.js") (resources.Get "/js/search-and-filter/filter-and-navigate-mobile-behavior.js") (resources.Get "/js/search-and-filter/search-logic.js") (resources.Get "/js/search-and-filter/search-handling.js") (resources.Get "/js/search-and-filter/change-handler-search-hook.js")
        | resources.Concat "js/mini_list.js" | minify | fingerprint  }}
    <script href="{{ $js_list.Permalink }}" defer></script>
{{end}}

<!-- Content pages only that are not _index, _next-steps, or _review -->
{{if and $is_content (not (hasPrefix .File.TranslationBaseName "_"))}}
{{/*
    {{ $js_prism := $all_page_js | append 
        (resources.Get "/js/prism.js") (resources.Get "/js/prism_post_output_formating.js")
        | resources.Concat "js/mini_prism.js" | minify | fingerprint  }}
    <script href="{{ $js_prism.Permalink }}" defer></script>
    */}}
    <script src="/js/prism.js" defer></script>
    <script src="/js/mini_prism.js" defer></script>       

{{end}}
{{if $is_content}}
    {{ $js_content := $all_page_js | append 
        (resources.Get "/js/search-and-filter/filter-and-navigate-mobile-behavior.js") (resources.Get "/js/feedback-form-behavior.js")
        | resources.Concat "js/mini_content.js" | minify | fingerprint  }}
    <script href="{{ $js_content.Permalink }}" defer></script>
{{end}}
{{if hasPrefix .File.TranslationBaseName "_review"}}
    {{ $js_review := $all_page_js | append 
        (resources.Get "/js/review-question-behavior.js")
        | resources.Concat "js/mini_review.js" | minify | fingerprint  }}
    <script href="{{ $js_review.Permalink }}" defer></script>
{{end}}


